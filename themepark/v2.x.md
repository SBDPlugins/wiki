# Upgrading the Panels

## **Upgrading from v2.x to v3.x:**

### With SSH access:

#### Step 1: Remove the old files & the database

First make a backup of your **.env** file. You need this file later. Remove all the files from our panel, except the **vendor** folder.

Also make sure to remove the old tables **attraction**, **region** and **statuses**. They have been redesigned, and the plugin will create them again. You can use this SQL query for that:

```sql
DROP TABLE attraction;
DROP TABLE region;
DROP TABLE statuses;
```

#### Step 2: Install the new files

Then you need to install the new files. Unzip the SSH zip, and upload the files to your panel.

#### Step 3: Editing the configuration

Run the following commands:

```bash
cp .env.example .env
nano .env
```

Then change all the settings in that file. Change the **APP\_URL** to the url of your panel, and **STORE\_URL** to the url of your store.

At **DB\_** you can change the database credentials of the database you created.

For the **MAIL\_** settings you have to create a mail account, and then lookup the **SMTP** server from your hosting. Ask your hosting for support if you are unable to do this.

{% hint style="warning" %}
**Pay attention!** Some hostings are using SSL or no encryption for the SMTP server. Then leave the MAIL\_ENCRYPTION setting empty.
{% endhint %}

Then run the following commands to install your panel and create your database:

```bash
php artisan key:generate --force
php artisan migrate --force
```

#### Step 4: Clear the caches

Laravel creates caches to make the pages load faster. You have to clear them when you upgrade your panel to load new pages.

```bash
php artisan view:clear
php artisan config:clear
```

#### Step 5: Set the new permissions

Because the file permissions in the ZIP are other then the file permissions used by the webserver, you have to update them. Run this command:

```bash
# Run this command if you are not running CentOS:
chown -R www-data:www-data * 

# Or if you are using Nginx on CentOS:
chown -R nginx:nginx *

# Or if you are using Apache on CentOS:
chown -R apache:apache *
```

#### Step 6: Update the plugin\(s\)

The plugin\(s\) have also had a recode. Just remove the old JARs, and the settings.yml and messages.yml from ThemePark and ThemeParkConnector. Also remove the signs.yml from ThemePark.

Then upload the new JARs. Restart your server, and change the newly generated config files from ThemePark to match the new settings. If you don't know how to do that, checkout [the Setup page](setup.md).

{% hint style="warning" %}
If you have installed ThemeParkPanelPlus, you have to install the files of it also again. Just put the ZIP into your main folder, and overwrite.
{% endhint %}

### Without SSH access:

#### Step 1: Remove the old files & the database

First make a backup of your **.env** file. You need this file later. Remove all the files from our panel, except the **vendor** folder.

Also make sure to remove the old tables **attraction**, **region** and **statuses**. They have been redesigned, and the plugin will create them again. You can use the SQL query below for that. Just run the queries on the PhpMyAdmin query page.

```sql
DROP TABLE attraction;
DROP TABLE region;
DROP TABLE statuses;
```

#### Step 2: Install the new files

Then you need to install the new files. Unzip the SSH zip, and upload the files to your panel.

#### Step 3: Editing the configuration

Now copy the **.env.example** file and rename it to **.env**. 

Then you have to change the settings in the **.env** file. Change the **APP\_URL** to the url of your panel, and **STORE\_URL** to the url of your store.

At **DB\_** you can change the database credentials of the database you created.

For the **MAIL\_** settings you have to create a mail account, and then lookup the **SMTP** server from your hosting. Ask your hosting for support if you are unable to do this.

{% hint style="warning" %}
**Pay attention!** Some hostings are using SSL or no encryption for the SMTP server. Then leave the MAIL\_ENCRYPTION setting empty.
{% endhint %}

#### Step 4: Update the plugin\(s\)

The plugin\(s\) have also had a recode. Just remove the old JARs, and the settings.yml from ThemePark and ThemeParkConnector. Also remove the messages.yml from ThemeParkConnector.

Then upload the new JARs. Restart your server, and change the newly generated config files from ThemePark to match the new settings. If you don't know how to do that, checkout [the Setup page](setup.md).

{% hint style="warning" %}
If you have installed ThemeParkPanelPlus, you have to install the files of it also again. Just put the ZIP into your main folder, and overwrite.
{% endhint %}

## Upgrading for minor updates:

### **With SSH access:**

#### **Step 1: Install the new files**

First you have to connect to your FTP. Then upload the new SSH zip to your panel. Overwrite all the files \(you can use the "if they are bigger / newer" option\).

Then you have to update the dependencies we use. Run this command:

```bash
composer install --no-dev --optimize-autoloader
```

#### Step 2: Upgrade the database

Then run the migration command to update the database.

```bash
php artisan migrate --force
```

#### Step 3: Clear the caches

Laravel creates caches to make the pages load faster. You have to clear them when you upgrade your panel to load new pages.

```bash
php artisan view:clear
php artisan config:clear
```

#### Step 4: Set the new permissions

Because the file permissions in the ZIP are other then the file permissions used by the webserver, you have to update them. Run this command:

```bash
# Run this command if you are not running CentOS:
chown -R www-data:www-data * 

# Or if you are using Nginx on CentOS:
chown -R nginx:nginx *

# Or if you are using Apache on CentOS:
chown -R apache:apache *
```

{% hint style="warning" %}
If you have installed ThemeParkPanelPlus, you have to install the files of it also again. Just put the ZIP into your main folder, and overwrite.
{% endhint %}

### Without SSH access:

#### **Step 1: Install the new files**

First you have to connect to your FTP. Then upload the new non-SSH zip to your panel. Overwrite all the files \(you can use the "if they are bigger / newer" option\).

#### Step 2: Upgrade the database

Now you have to upload the update SQL-file. Open your database with PHPMyAdmin, and go to Import in the menu, and then choose the SQL-file at "File to import:". Then click on the Start button. Now it's uploaded.

{% hint style="warning" %}
If you have installed ThemeParkPanelPlus, you have to install the files of it also again. Just put the ZIP into your main folder, and overwrite.
{% endhint %}

